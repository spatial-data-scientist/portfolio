/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.10.1
 */
import{r as t,c as s,h as e,g as i,F as n}from"./p-f4795882.js";import{C as o,n as a,a as l,b as c,o as r,c as h,d,D as u,e as p,f,g as m,p as b,j as g,k as w,H as x,O as y,t as v,l as C,m as k,S as A,q as S,r as z,R as D,s as $,i as I,u as j,v as F}from"./p-dc89244d.js";import{l as O,g as L,d as K,i as N}from"./p-2640495b.js";import{c as P,d as T,u as E,I as M}from"./p-9b36bd31.js";import{i as U}from"./p-6e53a6ba.js";import{c as H,s as _,a as B}from"./p-b7cbdc68.js";import{c as V,d as R}from"./p-f2cc19fa.js";import{r as q,c as X,a as W}from"./p-cbe389db.js";import{u as J,s as Y,c as G,d as Q}from"./p-659125bc.js";import{t as Z}from"./p-aa4624a4.js";import"./p-89a6ec33.js";import"./p-b7c6955c.js";import"./p-e81d258d.js";import"./p-f5c0037f.js";import"./p-5bd77fe8.js";const tt=':host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:inline-block;font-size:var(--calcite-font-size--2);line-height:1rem;font-weight:var(--calcite-font-weight-normal)}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}:host([scale=s]){--calcite-color-picker-spacing:8px}:host([scale=s]) .container{inline-size:160px}:host([scale=s]) .saved-colors{gap:0.25rem;grid-template-columns:repeat(auto-fill, 20px)}:host([scale=m]){--calcite-color-picker-spacing:12px}:host([scale=m]) .container{inline-size:272px}:host([scale=l]){--calcite-color-picker-spacing:16px;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=l]) .container{inline-size:464px}:host([scale=l]) .section:first-of-type{padding-block-start:var(--calcite-color-picker-spacing)}:host([scale=l]) .saved-colors{grid-template-columns:repeat(auto-fill, 32px)}:host([scale=l]) .control-section{flex-wrap:nowrap;align-items:baseline;flex-wrap:wrap}:host([scale=l]) .color-hex-options{display:flex;flex-shrink:1;flex-direction:column;justify-content:space-around}:host([scale=l]) .color-mode-container{flex-shrink:3}.container{background-color:var(--calcite-color-foreground-1);display:inline-block;border:1px solid var(--calcite-color-border-1)}.control-and-scope{position:relative;display:flex;cursor:pointer;touch-action:none}.scope{pointer-events:none;position:absolute;z-index:var(--calcite-z-index);block-size:1px;inline-size:1px;border-radius:9999px;background-color:transparent;font-size:var(--calcite-font-size--1);outline-color:transparent}.scope:focus{outline:2px solid var(--calcite-ui-focus-color, var(--calcite-color-brand));outline-offset:calc(\n            2px *\n            calc(\n              1 -\n              2 * clamp(\n                0,\n                var(--calcite-offset-invert-focus),\n                1\n              )\n            )\n          );outline-offset:6px}.hex-and-channels-group{inline-size:100%}.hex-and-channels-group,.control-section{display:flex;flex-direction:row;flex-wrap:wrap}.section{padding-block:0 var(--calcite-color-picker-spacing);padding-inline:var(--calcite-color-picker-spacing)}.section:first-of-type{padding-block-start:var(--calcite-color-picker-spacing)}.sliders{display:flex;flex-direction:column;justify-content:space-between;margin-inline-start:var(--calcite-color-picker-spacing);gap:var(--calcite-spacing-xxs)}.preview-and-sliders{display:flex;align-items:center;padding:var(--calcite-color-picker-spacing)}.color-hex-options,.section--split{flex-grow:1}.header{display:flex;align-items:center;justify-content:space-between;color:var(--calcite-color-text-1)}.color-mode-container{padding-block-start:var(--calcite-color-picker-spacing)}.channels{display:flex;row-gap:0.125rem}.channel[data-channel-index="3"]{inline-size:159px}:host([scale=s]) .channels{flex-wrap:wrap}:host([scale=s]) .channel{flex-basis:30%;flex-grow:1}:host([scale=s]) .channel[data-channel-index="3"]{inline-size:unset;margin-inline-start:unset}:host([scale=l]) .channel[data-channel-index="3"]{inline-size:131px}.saved-colors{display:grid;gap:0.5rem;padding-block-start:var(--calcite-color-picker-spacing);grid-template-columns:repeat(auto-fill, 24px)}.saved-colors-buttons{display:flex}.saved-color{outline-offset:0;outline-color:transparent;cursor:pointer}.saved-color:focus{outline:2px solid var(--calcite-color-brand);outline-offset:2px}.saved-color:hover{transition:outline-color var(--calcite-internal-animation-timing-fast) ease-in-out;outline:2px solid var(--calcite-color-border-2);outline-offset:2px}:host([hidden]){display:none}[hidden]{display:none}';const st=tt;const et=16;const it=class{constructor(i){t(this,i);this.calciteColorPickerChange=s(this,"calciteColorPickerChange",6);this.calciteColorPickerInput=s(this,"calciteColorPickerInput",6);this.internalColorUpdateContext=null;this.mode=o.HEX;this.shiftKeyChannelAdjustment=0;this.handleTabActivate=t=>{this.channelMode=t.currentTarget.getAttribute("data-color-mode");this.updateChannelsFromColor(this.color)};this.handleColorFieldScopeKeyDown=t=>{const{key:s}=t;const e={ArrowUp:{x:0,y:-10},ArrowRight:{x:10,y:0},ArrowDown:{x:0,y:10},ArrowLeft:{x:-10,y:0}};if(e[s]){t.preventDefault();this.scopeOrientation=s==="ArrowDown"||s==="ArrowUp"?"vertical":"horizontal";this.captureColorFieldColor(this.colorFieldScopeLeft+e[s].x||0,this.colorFieldScopeTop+e[s].y||0,false)}};this.handleHueScopeKeyDown=t=>{const s=t.shiftKey?10:1;const{key:e}=t;const i={ArrowUp:1,ArrowRight:1,ArrowDown:-1,ArrowLeft:-1};if(i[e]){t.preventDefault();const n=i[e]*s;const o=this.baseColorFieldColor.hue();const a=this.baseColorFieldColor.hue(o+n);this.internalColorSet(a,false)}};this.handleHexInputChange=t=>{t.stopPropagation();const{isClearable:s,color:e}=this;const i=t.target;const n=i.value;if(s&&!n){this.internalColorSet(null);return}const o=e&&a(l(e,f(this.mode)));if(n!==o){this.internalColorSet(c(n))}};this.handleSavedColorSelect=t=>{const s=t.currentTarget;this.internalColorSet(c(s.color))};this.handleChannelInput=t=>{const s=t.currentTarget;const e=Number(s.getAttribute("data-channel-index"));const i=e===3;const n=i?y.max:this.channelMode==="rgb"?D[Object.keys(D)[e]]:x[Object.keys(x)[e]];let o;if(this.isClearable&&!s.value){o=""}else{const t=Number(s.value);const e=t+this.shiftKeyChannelAdjustment;const i=X(e,0,n);o=i.toString()}s.value=o;if(o!==""&&this.shiftKeyChannelAdjustment!==0){this.handleChannelChange(t)}};this.handleChannelChange=t=>{const s=t.currentTarget;const e=Number(s.getAttribute("data-channel-index"));const i=[...this.channels];const n=this.isClearable&&!s.value;if(n){this.channels=[null,null,null,null];this.internalColorSet(null);return}const o=e===3;const a=Number(s.value);i[e]=o?r(a):a;this.updateColorFromChannels(i)};this.handleSavedColorKeyDown=t=>{if(U(t.key)){t.preventDefault();this.handleSavedColorSelect(t)}};this.handleColorFieldPointerDown=t=>{if(!O(t)){return}const{offsetX:s,offsetY:e}=t;window.addEventListener("pointermove",this.globalPointerMoveHandler);window.addEventListener("pointerup",this.globalPointerUpHandler,{once:true});this.activeCanvasInfo={context:this.colorFieldRenderingContext,bounds:this.colorFieldRenderingContext.canvas.getBoundingClientRect()};this.captureColorFieldColor(s,e);this.colorFieldScopeNode.focus()};this.handleHueSliderPointerDown=t=>{if(!O(t)){return}const{offsetX:s}=t;window.addEventListener("pointermove",this.globalPointerMoveHandler);window.addEventListener("pointerup",this.globalPointerUpHandler,{once:true});this.activeCanvasInfo={context:this.hueSliderRenderingContext,bounds:this.hueSliderRenderingContext.canvas.getBoundingClientRect()};this.captureHueSliderColor(s);this.hueScopeNode.focus()};this.handleOpacitySliderPointerDown=t=>{if(!O(t)){return}const{offsetX:s}=t;window.addEventListener("pointermove",this.globalPointerMoveHandler);window.addEventListener("pointerup",this.globalPointerUpHandler,{once:true});this.activeCanvasInfo={context:this.opacitySliderRenderingContext,bounds:this.opacitySliderRenderingContext.canvas.getBoundingClientRect()};this.captureOpacitySliderValue(s);this.opacityScopeNode.focus()};this.globalPointerUpHandler=t=>{if(!O(t)){return}const s=this.activeCanvasInfo;this.activeCanvasInfo=null;this.drawColorControls();if(s){this.calciteColorPickerChange.emit()}};this.globalPointerMoveHandler=t=>{const{activeCanvasInfo:s,el:e}=this;if(!e.isConnected||!s){return}const{context:i,bounds:n}=s;let o;let a;const{clientX:l,clientY:c}=t;if(i.canvas.matches(":hover")){o=l-n.x;a=c-n.y}else{if(l<n.x+n.width&&l>n.x){o=l-n.x}else if(l<n.x){o=0}else{o=n.width}if(c<n.y+n.height&&c>n.y){a=c-n.y}else if(c<n.y){a=0}else{a=n.height}}if(i===this.colorFieldRenderingContext){this.captureColorFieldColor(o,a,false)}else if(i===this.hueSliderRenderingContext){this.captureHueSliderColor(o)}else if(i===this.opacitySliderRenderingContext){this.captureOpacitySliderValue(o)}};this.storeColorFieldScope=t=>{this.colorFieldScopeNode=t};this.storeHueScope=t=>{this.hueScopeNode=t};this.renderChannelsTabTitle=t=>{const{channelMode:s,messages:i}=this;const n=t===s;const o=t==="rgb"?i.rgb:i.hsv;return e("calcite-tab-title",{class:h.colorMode,"data-color-mode":t,key:t,onCalciteTabsActivate:this.handleTabActivate,selected:n},o)};this.renderChannelsTab=t=>{const{isClearable:s,channelMode:i,channels:n,messages:o,alphaChannel:a}=this;const l=t===i;const c=t==="rgb";const r=c?[o.red,o.green,o.blue]:[o.hue,o.saturation,o.value];const u=L(this.el);const p=a?n:n.slice(0,3);return e("calcite-tab",{class:h.control,key:t,selected:l},e("div",{class:h.channels,dir:"ltr"},p.map(((t,e)=>{const i=e===3;if(i){t=s&&!t?t:d(t)}return this.renderChannel(t,e,r[e],u,i?"%":"")}))))};this.renderChannel=(t,s,i,n,o)=>e("calcite-input-number",{class:h.channel,"data-channel-index":s,dir:n,key:s,label:i,lang:this.effectiveLocale,numberButtonType:"none",numberingSystem:this.numberingSystem,onCalciteInputNumberChange:this.handleChannelChange,onCalciteInputNumberInput:this.handleChannelInput,onKeyDown:this.handleKeyDown,scale:this.scale==="l"?"m":"s",style:{marginLeft:s>0&&!(this.scale==="s"&&this.alphaChannel&&s===3)?"-1px":""},suffixText:o,value:t?.toString()});this.deleteColor=()=>{const t=l(this.color,this.alphaChannel);const s=this.savedColors.indexOf(t)>-1;if(!s){return}const e=this.savedColors.filter((s=>s!==t));this.savedColors=e;const i=`${S}${this.storageId}`;if(this.storageId){localStorage.setItem(i,JSON.stringify(e))}};this.saveColor=()=>{const t=l(this.color,this.alphaChannel);const s=this.savedColors.indexOf(t)>-1;if(s){return}const e=[...this.savedColors,t];this.savedColors=e;const i=`${S}${this.storageId}`;if(this.storageId){localStorage.setItem(i,JSON.stringify(e))}};this.drawColorControls=Z(((t="all")=>{if((t==="all"||t==="color-field")&&this.colorFieldRenderingContext){this.drawColorField()}if((t==="all"||t==="hue-slider")&&this.hueSliderRenderingContext){this.drawHueSlider()}if(this.alphaChannel&&(t==="all"||t==="opacity-slider")&&this.opacitySliderRenderingContext){this.drawOpacitySlider()}}),et);this.captureColorFieldColor=(t,s,e=true)=>{const{dimensions:{colorField:{height:i,width:n}}}=this;const o=Math.round(x.s/n*t);const a=Math.round(x.v/i*(i-s));this.internalColorSet(this.baseColorFieldColor.hsv().saturationv(o).value(a),e)};this.initColorField=t=>{this.colorFieldRenderingContext=t.getContext("2d");this.updateCanvasSize("color-field");this.drawColorControls()};this.initHueSlider=t=>{this.hueSliderRenderingContext=t.getContext("2d");this.updateCanvasSize("hue-slider");this.drawHueSlider()};this.initOpacitySlider=t=>{if(!t){return}this.opacitySliderRenderingContext=t.getContext("2d");this.updateCanvasSize("opacity-slider");this.drawOpacitySlider()};this.storeOpacityScope=t=>{this.opacityScopeNode=t};this.handleOpacityScopeKeyDown=t=>{const s=t.shiftKey?10:1;const{key:e}=t;const i={ArrowUp:.01,ArrowRight:.01,ArrowDown:-.01,ArrowLeft:-.01};if(i[e]){t.preventDefault();const n=i[e]*s;const o=this.baseColorFieldColor.alpha();const a=this.baseColorFieldColor.alpha(o+n);this.internalColorSet(a,false)}};this.allowEmpty=false;this.alphaChannel=false;this.channelsDisabled=false;this.clearable=false;this.color=u;this.disabled=false;this.format="auto";this.hideChannels=false;this.hexDisabled=false;this.hideHex=false;this.hideSaved=false;this.savedDisabled=false;this.scale="m";this.storageId=undefined;this.messageOverrides=undefined;this.numberingSystem=undefined;this.value=a(l(u,this.alphaChannel));this.channelMode="rgb";this.channels=this.toChannels(u);this.defaultMessages=undefined;this.dimensions=p.m;this.effectiveLocale="";this.messages=undefined;this.savedColors=[];this.colorFieldScopeTop=undefined;this.colorFieldScopeLeft=undefined;this.hueScopeLeft=undefined;this.opacityScopeLeft=undefined;this.scopeOrientation=undefined}handleAllowEmptyOrClearableChange(){this.isClearable=this.clearable||this.allowEmpty}handleAlphaChannelChange(t){const{format:s}=this;if(t&&s!=="auto"&&!f(s)){console.warn(`ignoring alphaChannel as the current format (${s}) does not support alpha`);this.alphaChannel=false}}handleAlphaChannelDimensionsChange(){this.effectiveSliderWidth=m(this.dimensions,this.alphaChannel);this.drawColorControls()}handleColorChange(t,s){this.drawColorControls();this.updateChannelsFromColor(t);this.previousColor=s}handleFormatOrAlphaChannelChange(){this.setMode(this.format);this.internalColorSet(this.color,false,"internal")}handleScaleChange(t="m"){this.updateDimensions(t);this.updateCanvasSize("all");this.drawColorControls()}onMessagesChange(){}handleValueChange(t,s){const{isClearable:e,format:i}=this;const n=!e||t;let o=false;if(n){const e=b(t);if(!e||i!=="auto"&&e!==i){this.showIncompatibleColorWarning(t,i);this.value=s;return}o=this.mode!==e;this.setMode(e,this.internalColorUpdateContext===null)}const a=this.activeCanvasInfo;if(this.internalColorUpdateContext==="initial"){return}if(this.internalColorUpdateContext==="user-interaction"){this.calciteColorPickerInput.emit();if(!a){this.calciteColorPickerChange.emit()}return}const l=e&&!t?null:c(t!=null&&typeof t==="object"&&f(this.mode)?g(t):t);const r=!w(l,this.color);if(o||r){this.internalColorSet(l,this.alphaChannel&&!(this.mode.endsWith("a")||this.mode.endsWith("a-css")),"internal")}}get baseColorFieldColor(){return this.color||this.previousColor||u}effectiveLocaleChange(){J(this,this.effectiveLocale)}handleChannelKeyUpOrDown(t){this.shiftKeyChannelAdjustment=0;const{key:s}=t;if(s!=="ArrowUp"&&s!=="ArrowDown"||!t.composedPath().some((t=>t.classList?.contains(h.channel)))){return}const{shiftKey:e}=t;t.preventDefault();if(!this.color){this.internalColorSet(this.previousColor);t.stopPropagation();return}const i=9;this.shiftKeyChannelAdjustment=s==="ArrowUp"&&e?i:s==="ArrowDown"&&e?-i:0}async setFocus(){await H(this);this.el.focus()}async componentWillLoad(){_(this);this.handleAllowEmptyOrClearableChange();this.handleAlphaChannelDimensionsChange();const{isClearable:t,color:s,format:e,value:i}=this;const n=t&&!i;const o=b(i);const a=n||e==="auto"&&o||e===o;const l=n?null:a?c(i):s;if(!a){this.showIncompatibleColorWarning(i,e)}this.setMode(e,false);this.internalColorSet(l,false,"initial");this.updateDimensions(this.scale);const r=`${S}${this.storageId}`;if(this.storageId&&localStorage.getItem(r)){this.savedColors=JSON.parse(localStorage.getItem(r))}await Y(this)}connectedCallback(){P(this);V(this);G(this)}componentDidLoad(){B(this)}disconnectedCallback(){window.removeEventListener("pointermove",this.globalPointerMoveHandler);window.removeEventListener("pointerup",this.globalPointerUpHandler);T(this);R(this);Q(this)}componentDidRender(){E(this)}render(){const{channelsDisabled:t,color:s,colorFieldScopeLeft:i,colorFieldScopeTop:n,dimensions:{thumb:{radius:o}},hexDisabled:a,hideChannels:c,hideHex:r,hideSaved:p,hueScopeLeft:f,messages:m,alphaChannel:b,opacityScopeLeft:g,savedColors:w,savedDisabled:v,scale:C,scopeOrientation:k}=this;const A=this.effectiveSliderWidth;const S=s?l(s,b):null;const z=o;const D=f??A*u.hue()/x.h;const $=o;const I=g??A*d(u.alpha())/y.max;const j=s===null;const F=k==="vertical";const O=a||r;const L=t||c;const K=v||p;const[N,P]=this.getAdjustedScopePosition(i,n);const[T,E]=this.getAdjustedScopePosition(D,z);const[U,H]=this.getAdjustedScopePosition(I,$);return e(M,{key:"ed8d6d887db9dc3d3e345b52b290094bde5541a8",disabled:this.disabled},e("div",{key:"06f7fc8c31b3165de13f20219d7c138f162e059d",class:h.container},e("div",{key:"79d751d245545fe729cb62660436ac67589a4be8",class:h.controlAndScope},e("canvas",{key:"6fa2716d392b2f41f7c96e21d6e30c7738df4191",class:h.colorField,onPointerDown:this.handleColorFieldPointerDown,ref:this.initColorField}),e("div",{key:"c51f4c15946f87bb71674c3aadd024cbd7514d55","aria-label":F?m.value:m.saturation,"aria-valuemax":F?x.v:x.s,"aria-valuemin":"0","aria-valuenow":(F?s?.saturationv():s?.value())||"0",class:{[h.scope]:true,[h.colorFieldScope]:true},onKeyDown:this.handleColorFieldScopeKeyDown,ref:this.storeColorFieldScope,role:"slider",style:{top:`${P||0}px`,left:`${N||0}px`},tabindex:"0"})),e("div",{key:"6f93b38c9b16234cd5bd68edbc6c44ed4351fab4",class:h.previewAndSliders},e("calcite-color-picker-swatch",{key:"dd12a18e453040e5af19c1e37ccbec3573cfd06b",class:h.preview,color:S,scale:this.alphaChannel?"l":this.scale}),e("div",{key:"cf3b9c928b0d43f912726d13b584afd90f028aa5",class:h.sliders},e("div",{key:"77906dfdb66f64405ae2a62c942064d66eccf22d",class:h.controlAndScope},e("canvas",{key:"1b8ed2fd600e16ddd34c3e3d97ee7c3c3fc21125",class:{[h.slider]:true,[h.hueSlider]:true},onPointerDown:this.handleHueSliderPointerDown,ref:this.initHueSlider}),e("div",{key:"73cb98a5adfd188433c434c0f832ac660f00966f","aria-label":m.hue,"aria-valuemax":x.h,"aria-valuemin":"0","aria-valuenow":s?.round().hue()||u.round().hue(),class:{[h.scope]:true,[h.hueScope]:true},onKeyDown:this.handleHueScopeKeyDown,ref:this.storeHueScope,role:"slider",style:{top:`${E}px`,left:`${T}px`},tabindex:"0"})),b?e("div",{class:h.controlAndScope},e("canvas",{class:{[h.slider]:true,[h.opacitySlider]:true},onPointerDown:this.handleOpacitySliderPointerDown,ref:this.initOpacitySlider}),e("div",{"aria-label":m.opacity,"aria-valuemax":y.max,"aria-valuemin":y.min,"aria-valuenow":(s||u).round().alpha(),class:{[h.scope]:true,[h.opacityScope]:true},onKeyDown:this.handleOpacityScopeKeyDown,ref:this.storeOpacityScope,role:"slider",style:{top:`${H}px`,left:`${U}px`},tabindex:"0"})):null)),O&&L?null:e("div",{class:{[h.controlSection]:true,[h.section]:true}},e("div",{class:h.hexAndChannelsGroup},O?null:e("div",{class:h.hexOptions},e("calcite-color-picker-hex-input",{allowEmpty:this.isClearable,alphaChannel:b,class:h.control,messages:m,numberingSystem:this.numberingSystem,onCalciteColorPickerHexInputChange:this.handleHexInputChange,scale:C,value:S})),L?null:e("calcite-tabs",{class:{[h.colorModeContainer]:true,[h.splitSection]:true},scale:C==="l"?"m":"s"},e("calcite-tab-nav",{slot:"title-group"},this.renderChannelsTabTitle("rgb"),this.renderChannelsTabTitle("hsv")),this.renderChannelsTab("rgb"),this.renderChannelsTab("hsv")))),K?null:e("div",{class:{[h.savedColorsSection]:true,[h.section]:true}},e("div",{class:h.header},e("label",null,m.saved),e("div",{class:h.savedColorsButtons},e("calcite-button",{appearance:"transparent",class:h.deleteColor,disabled:j,iconStart:"minus",kind:"neutral",label:m.deleteColor,onClick:this.deleteColor,scale:C,type:"button"}),e("calcite-button",{appearance:"transparent",class:h.saveColor,disabled:j,iconStart:"plus",kind:"neutral",label:m.saveColor,onClick:this.saveColor,scale:C,type:"button"}))),w.length>0?e("div",{class:h.savedColors},[...w.map((t=>e("calcite-color-picker-swatch",{class:h.savedColor,color:t,key:t,onClick:this.handleSavedColorSelect,onKeyDown:this.handleSavedColorKeyDown,scale:C,tabIndex:0})))]):null)))}handleKeyDown(t){if(t.key==="Enter"){t.preventDefault()}}showIncompatibleColorWarning(t,s){console.warn(`ignoring color value (${t}) as it is not compatible with the current format (${s})`)}setMode(t,s=true){const e=t==="auto"?this.mode:t;this.mode=this.ensureCompatibleMode(e,s)}ensureCompatibleMode(t,s){const{alphaChannel:e}=this;const i=f(t);if(e&&!i){const e=z(t);if(s){console.warn(`setting format to (${e}) as the provided one (${t}) does not support alpha`)}return e}if(!e&&i){const e=v(t);if(s){console.warn(`setting format to (${e}) as the provided one (${t}) does not support alpha`)}return e}return t}captureHueSliderColor(t){const s=k/this.effectiveSliderWidth*t;this.internalColorSet(this.baseColorFieldColor.hue(s),false)}captureOpacitySliderValue(t){const s=r(y.max/this.effectiveSliderWidth*t);this.internalColorSet(this.baseColorFieldColor.alpha(s),false)}internalColorSet(t,s=true,e="user-interaction"){if(s&&w(t,this.color)){return}this.internalColorUpdateContext=e;this.color=t;this.value=this.toValue(t);this.internalColorUpdateContext=null}toValue(t,s=this.mode){if(!t){return null}const e="hex";if(s.includes(e)){const e=s===o.HEXA;return a(l(t.round(),e),e)}if(s.includes("-css")){const e=t[s.replace("-css","").replace("a","")]().round().string();const i=(s.endsWith("a")||s.endsWith("a-css"))&&t.alpha()===1;if(i){const s=e.slice(0,3);const i=e.slice(4,-1);return`${s}a(${i}, ${t.alpha()})`}return e}const i=t[v(s)]().round().object();if(s.endsWith("a")){return C(i)}return i}getSliderCapSpacing(){const{dimensions:{slider:{height:t},thumb:{radius:s}}}=this;return s*2-t}updateDimensions(t="m"){this.dimensions=p[t]}drawColorField(){const t=this.colorFieldRenderingContext;const{dimensions:{colorField:{height:s,width:e}}}=this;t.fillStyle=this.baseColorFieldColor.hsv().saturationv(100).value(100).alpha(1).string();t.fillRect(0,0,e,s);const i=t.createLinearGradient(0,0,e,0);i.addColorStop(0,"rgba(255,255,255,1)");i.addColorStop(1,"rgba(255,255,255,0)");t.fillStyle=i;t.fillRect(0,0,e,s);const n=t.createLinearGradient(0,0,0,s);n.addColorStop(0,"rgba(0,0,0,0)");n.addColorStop(1,"rgba(0,0,0,1)");t.fillStyle=n;t.fillRect(0,0,e,s);this.drawActiveColorFieldColor()}setCanvasContextSize(t,{height:s,width:e}){if(!t){return}const i=window.devicePixelRatio||1;t.width=e*i;t.height=s*i;t.style.height=`${s}px`;t.style.width=`${e}px`;const n=t.getContext("2d");n.scale(i,i)}updateCanvasSize(t="all"){const{dimensions:s}=this;if(t==="all"||t==="color-field"){this.setCanvasContextSize(this.colorFieldRenderingContext?.canvas,s.colorField)}const e={width:this.effectiveSliderWidth,height:s.slider.height+(s.thumb.radius-s.slider.height/2)*2};if(t==="all"||t==="hue-slider"){this.setCanvasContextSize(this.hueSliderRenderingContext?.canvas,e)}if(t==="all"||t==="opacity-slider"){this.setCanvasContextSize(this.opacitySliderRenderingContext?.canvas,e)}}drawActiveColorFieldColor(){const{color:t}=this;if(!t){return}const s=t.hsv();const{dimensions:{colorField:{height:e,width:i},thumb:{radius:n}}}=this;const o=s.saturationv()/(x.s/i);const a=e-s.value()/(x.v/e);requestAnimationFrame((()=>{this.colorFieldScopeLeft=o;this.colorFieldScopeTop=a}));this.drawThumb(this.colorFieldRenderingContext,n,o,a,s,false)}drawThumb(t,s,e,i,n,o){const a=0;const l=2*Math.PI;const c=1;t.beginPath();t.arc(e,i,s,a,l);t.fillStyle="#fff";t.fill();t.strokeStyle="rgba(0,0,0,0.3)";t.lineWidth=c;t.stroke();if(o&&n.alpha()<1){const n=t.createPattern(this.getCheckeredBackgroundPattern(),"repeat");t.beginPath();t.arc(e,i,s-3,a,l);t.fillStyle=n;t.fill()}t.globalCompositeOperation="source-atop";t.beginPath();t.arc(e,i,s-3,a,l);const r=o?n.alpha():1;t.fillStyle=n.rgb().alpha(r).string();t.fill();t.globalCompositeOperation="source-over"}drawActiveHueSliderColor(){const{color:t}=this;if(!t){return}const s=t.hsv().saturationv(100).value(100);const{dimensions:{thumb:{radius:e}}}=this;const i=this.effectiveSliderWidth;const n=s.hue()/(k/i);const o=e;const a=this.getSliderBoundX(n,i,e);requestAnimationFrame((()=>{this.hueScopeLeft=a}));this.drawThumb(this.hueSliderRenderingContext,e,a,o,s,false)}drawHueSlider(){const t=this.hueSliderRenderingContext;const{dimensions:{slider:{height:s},thumb:{radius:e}}}=this;const i=0;const n=e-s/2;const o=this.effectiveSliderWidth;const a=t.createLinearGradient(0,0,o,0);const l=["red","yellow","lime","cyan","blue","magenta","#ff0004"];const r=1/(l.length-1);let h=0;l.forEach((t=>{a.addColorStop(h,c(t).string());h+=r}));t.clearRect(0,0,o,s+this.getSliderCapSpacing()*2);this.drawSliderPath(t,s,o,i,n);t.fillStyle=a;t.fill();t.strokeStyle="rgba(0,0,0,0.3)";t.lineWidth=1;t.stroke();this.drawActiveHueSliderColor()}drawOpacitySlider(){const t=this.opacitySliderRenderingContext;const{baseColorFieldColor:s,dimensions:{slider:{height:e},thumb:{radius:i}}}=this;const n=0;const o=i-e/2;const a=this.effectiveSliderWidth;t.clearRect(0,0,a,e+this.getSliderCapSpacing()*2);const l=t.createLinearGradient(0,o,a,0);const c=s.rgb().alpha(0);const r=s.rgb().alpha(.5);const h=s.rgb().alpha(1);l.addColorStop(0,c.string());l.addColorStop(.5,r.string());l.addColorStop(1,h.string());this.drawSliderPath(t,e,a,n,o);const d=t.createPattern(this.getCheckeredBackgroundPattern(),"repeat");t.fillStyle=d;t.fill();t.fillStyle=l;t.fill();t.strokeStyle="rgba(0,0,0,0.3)";t.lineWidth=1;t.stroke();this.drawActiveOpacitySliderColor()}drawSliderPath(t,s,e,i,n){const o=s/2+1;t.beginPath();t.moveTo(i+o,n);t.lineTo(i+e-o,n);t.quadraticCurveTo(i+e,n,i+e,n+o);t.lineTo(i+e,n+s-o);t.quadraticCurveTo(i+e,n+s,i+e-o,n+s);t.lineTo(i+o,n+s);t.quadraticCurveTo(i,n+s,i,n+s-o);t.lineTo(i,n+o);t.quadraticCurveTo(i,n,i+o,n);t.closePath()}getCheckeredBackgroundPattern(){if(this.checkerPattern){return this.checkerPattern}const t=document.createElement("canvas");t.width=10;t.height=10;const s=t.getContext("2d");s.fillStyle="#ccc";s.fillRect(0,0,10,10);s.fillStyle="#fff";s.fillRect(0,0,5,5);s.fillRect(5,5,5,5);this.checkerPattern=t;return t}drawActiveOpacitySliderColor(){const{color:t}=this;if(!t){return}const s=t;const{dimensions:{thumb:{radius:e}}}=this;const i=this.effectiveSliderWidth;const n=d(s.alpha())/(y.max/i);const o=e;const a=this.getSliderBoundX(n,i,e);requestAnimationFrame((()=>{this.opacityScopeLeft=a}));this.drawThumb(this.opacitySliderRenderingContext,e,a,o,s,true)}getSliderBoundX(t,s,e){const i=W(t,s,e);return i===0?t:i===-1?q(t,0,s,e,e*2):q(t,0,s,s-e*2,s-e)}updateColorFromChannels(t){this.internalColorSet(c(t,this.channelMode))}updateChannelsFromColor(t){this.channels=t?this.toChannels(t):[null,null,null,null]}toChannels(t){const{channelMode:s}=this;const e=t[s]().array().map(((t,s)=>{const e=s===3;return e?t:Math.floor(t)}));if(e.length===3){e.push(1)}return e}getAdjustedScopePosition(t,s){return[t-A/2,s-A/2]}static get delegatesFocus(){return true}static get assetsDirs(){return["assets"]}get el(){return i(this)}static get watchers(){return{allowEmpty:["handleAllowEmptyOrClearableChange"],clearable:["handleAllowEmptyOrClearableChange"],alphaChannel:["handleAlphaChannelChange","handleAlphaChannelDimensionsChange","handleFormatOrAlphaChannelChange"],dimensions:["handleAlphaChannelDimensionsChange"],color:["handleColorChange"],format:["handleFormatOrAlphaChannelChange"],scale:["handleScaleChange"],messageOverrides:["onMessagesChange"],value:["handleValueChange"],effectiveLocale:["effectiveLocaleChange"]}}};it.style=st;const nt={container:"container",hexInput:"hex-input",opacityInput:"opacity-input"};const ot=":host{display:block}.container{display:flex;inline-size:100%;flex-wrap:nowrap;align-items:center}.hex-input{flex-grow:1;text-transform:uppercase}.opacity-input{inline-size:68px;margin-inline-start:-1px}:host([scale=s]) .container{flex-wrap:wrap;row-gap:0.125rem}:host([scale=s]) .opacity-input{inline-size:unset;margin-inline-start:unset}:host([scale=l]) .opacity-input{inline-size:88px}:host([hidden]){display:none}[hidden]{display:none}";const at=ot;const lt=c();const ct=class{constructor(e){t(this,e);this.calciteColorPickerHexInputChange=s(this,"calciteColorPickerHexInputChange",6);this.onHexInputBlur=()=>{const t=this.hexInputNode;const s=t.value;const e=`#${s}`;const{allowEmpty:i,internalColor:n}=this;const o=i&&!s;const a=$(e);this.onHexInputChange();if(o||I(e)&&a){return}t.value=i&&!n?"":this.formatHexForInternalInput(j(n.object()))};this.onOpacityInputBlur=()=>{const t=this.opacityInputNode;const s=t.value;const{allowEmpty:e,internalColor:i}=this;const n=e&&!s;if(n){return}t.value=e&&!i?"":this.formatOpacityForInternalInput(i)};this.onHexInputChange=()=>{const t=this.hexInputNode.value;let s=t;if(s){const t=a(s,false);const e=I(t)&&this.alphaChannel;if(e&&this.internalColor){const e=a(this.internalColor.hexa(),true).slice(-2);s=`${t+e}`}}this.internalSetValue(s,this.value)};this.onOpacityInputChange=()=>{const t=this.opacityInputNode;let s;if(!t.value){s=t.value}else{const e=r(Number(t.value));s=this.internalColor?.alpha(e).hexa()}this.internalSetValue(s,this.value)};this.onHexInput=()=>{const t=`#${this.hexInputNode.value}`;const s=this.value;if(I(t,this.alphaChannel)&&$(t,this.alphaChannel)){this.internalSetValue(t,s)}};this.onInputKeyDown=t=>{const{altKey:s,ctrlKey:e,metaKey:i,shiftKey:n}=t;const{alphaChannel:o,hexInputNode:a,internalColor:c,value:r}=this;const{key:h}=t;const d=t.composedPath();if(h==="Tab"||h==="Enter"){if(d.includes(a)){this.onHexInputChange()}else{this.onOpacityInputChange()}if(h==="Enter"){t.preventDefault()}return}const u=h==="ArrowDown"||h==="ArrowUp";const p=this.value;if(u){if(!r){this.internalSetValue(this.previousNonNullValue,p);t.preventDefault();return}const s=h==="ArrowUp"?1:-1;const e=n?10:1;this.internalSetValue(l(this.nudgeRGBChannels(c,e*s,d.includes(a)?"rgb":"a"),o),p);t.preventDefault();return}const f=s||e||i;const m=h.length===1;const b=F.test(h);if(m&&!f&&!b){t.preventDefault()}};this.onHexInputPaste=t=>{const s=t.clipboardData.getData("text");if(I(s,this.alphaChannel)&&$(s,this.alphaChannel)){t.preventDefault();this.hexInputNode.value=s.slice(1);this.internalSetValue(s,this.value)}};this.previousNonNullValue=this.value;this.storeHexInputRef=t=>{this.hexInputNode=t};this.storeOpacityInputRef=t=>{this.opacityInputNode=t};this.allowEmpty=false;this.alphaChannel=false;this.hexLabel="Hex";this.messages=undefined;this.numberingSystem=undefined;this.scale="m";this.value=a(l(lt,this.alphaChannel),this.alphaChannel,true);this.internalColor=lt}connectedCallback(){const{allowEmpty:t,alphaChannel:s,value:e}=this;if(e){const t=a(e,s);if(I(t,s)){this.internalSetValue(t,t,false)}return}if(t){this.internalSetValue(null,null,false)}}componentWillLoad(){_(this)}componentDidLoad(){B(this)}handleValueChange(t,s){this.internalSetValue(t,s,false)}render(){const{alphaChannel:t,hexLabel:s,internalColor:i,messages:n,scale:o,value:a}=this;const l=this.formatHexForInternalInput(a);const c=this.formatOpacityForInternalInput(i);const r=o==="l"?"m":"s";return e("div",{key:"9939540e0bf570287d03276311c4d077e2ce1ae4",class:nt.container},e("calcite-input-text",{key:"d2b6ab840fbd55bf16c6c5efe46d51e65b909cde",class:nt.hexInput,label:n?.hex||s,maxLength:6,onCalciteInputTextChange:this.onHexInputChange,onCalciteInputTextInput:this.onHexInput,onCalciteInternalInputTextBlur:this.onHexInputBlur,onKeyDown:this.onInputKeyDown,onPaste:this.onHexInputPaste,prefixText:"#",ref:this.storeHexInputRef,scale:r,value:l}),t?e("calcite-input-number",{class:nt.opacityInput,key:"opacity-input",label:n?.opacity,max:y.max,maxLength:3,min:y.min,numberButtonType:"none",numberingSystem:this.numberingSystem,onCalciteInputNumberChange:this.onOpacityInputChange,onCalciteInternalInputNumberBlur:this.onOpacityInputBlur,onKeyDown:this.onInputKeyDown,ref:this.storeOpacityInputRef,scale:r,suffixText:"%",value:c}):null)}async setFocus(){await H(this);return K(this.hexInputNode)}internalSetValue(t,s,e=true){if(t){const{alphaChannel:s}=this;const i=a(t,s,s);if(I(i,s)){const{internalColor:t}=this;const n=c(i);const o=a(l(n,s),s);const r=!t||o!==a(l(t,s),s);this.internalColor=n;this.previousNonNullValue=o;this.value=o;if(r&&e){this.calciteColorPickerHexInputChange.emit()}return}}else if(this.allowEmpty){this.internalColor=null;this.value=null;if(e){this.calciteColorPickerHexInputChange.emit()}return}this.value=s}formatHexForInternalInput(t){return t?t.replace("#","").slice(0,6):""}formatOpacityForInternalInput(t){return t?`${d(t.alpha())}`:""}nudgeRGBChannels(t,s,e){let i;const n=t.array();const o=n.slice(0,3);if(e==="rgb"){const t=o.map((t=>t+s));i=[...t,this.alphaChannel?n[3]:undefined]}else{const e=r(d(t.alpha())+s);i=[...o,e]}return c(i)}get el(){return i(this)}static get watchers(){return{value:["handleValueChange"]}}};ct.style=at;const rt={swatch:"swatch",noColorSwatch:"swatch--no-color",checker:"checker"};const ht={borderLight:"rgba(0, 0, 0, 0.3)",borderDark:"rgba(255, 255, 255, 0.15)"};const dt=4;const ut={squareSize:dt,size:dt*2};const pt=":host{position:relative;display:inline-flex}:host([scale=s]){block-size:1.25rem;inline-size:1.25rem}:host([scale=m]){block-size:1.5rem;inline-size:1.5rem}:host([scale=l]){block-size:2rem;inline-size:2rem}.swatch{overflow:hidden;block-size:inherit;inline-size:inherit}.swatch rect{transition-property:all;transition-duration:150ms;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1)}.swatch--no-color rect{fill:var(--calcite-color-foreground-1)}.swatch--no-color line{stroke:var(--calcite-color-status-danger)}.checker{fill:#cacaca}:host([hidden]){display:none}[hidden]{display:none}";const ft=pt;const mt=class{constructor(s){t(this,s);this.active=false;this.color=undefined;this.scale="m"}handleColorChange(t){this.internalColor=t?c(t):null}componentWillLoad(){this.handleColorChange(this.color)}render(){const t=!this.internalColor;const s={[rt.swatch]:true,[rt.noColorSwatch]:t};return e("svg",{key:"b29377be8ce0518f7b0f3691dcb1dda08890dd94",class:s,xmlns:"http://www.w3.org/2000/svg"},this.renderSwatch())}renderSwatch(){const{active:t,el:s,internalColor:i}=this;const o=t?"100%":"0";const a=N(s);const c=a==="light"?ht.borderLight:ht.borderDark;const r={height:"100%",rx:o,stroke:c,["stroke-width"]:"2",width:"100%"};const h=!i;if(h){return e(n,null,e("clipPath",{id:"shape"},e("rect",{height:"100%",rx:o,width:"100%"})),e("rect",{"clip-path":`inset(0 round ${o})`,rx:o,...r}),e("line",{"clip-path":"url(#shape)","stroke-width":"3",x1:"100%",x2:"0",y1:"0",y2:"100%"}))}const d=i.alpha();const u=l(i);const p=l(i,d<1);return e(n,null,e("title",null,p),e("defs",null,e("pattern",{height:ut.size,id:"checker",patternUnits:"userSpaceOnUse",width:ut.size,x:"0",y:"0"},e("rect",{class:rt.checker,height:ut.squareSize,width:ut.squareSize,x:"0",y:"0"}),e("rect",{class:rt.checker,height:ut.squareSize,width:ut.squareSize,x:ut.squareSize,y:ut.squareSize}))),e("rect",{fill:"url(#checker)",height:"100%",rx:o,width:"100%"}),e("rect",{fill:u,style:{"clip-path":d<1?"polygon(100% 0, 0 0, 0 100%)":`inset(0 round ${o})`},...r}),d<1?e("rect",{fill:p,key:"opacity-fill",style:{"clip-path":"polygon(100% 0, 100% 100%, 0 100%)"},...r}):null)}get el(){return i(this)}static get watchers(){return{color:["handleColorChange"]}}};mt.style=ft;export{it as calcite_color_picker,ct as calcite_color_picker_hex_input,mt as calcite_color_picker_swatch};
//# sourceMappingURL=p-4310be36.entry.js.map