/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import r from"./aspectProcessor.js";import e from"./bandArithmeticProcessor.js";import o from"./compositeBandProcessor.js";import t from"./computeChangeProcessor.js";import s from"./contrastProcessor.js";import c from"./convolutionProcessor.js";import n from"./curvatureProcessor.js";import i from"./extractBandProcessor.js";import m from"./focalStatisticsProcessor.js";import a from"./grayscaleProcessor.js";import p from"./localProcessor.js";import u from"./maskProcessor.js";import f from"./ndviProcessor.js";import l from"./remapProcessor.js";import j from"./reprojectProcessor.js";import d from"./slopeProcessor.js";import P from"./stretchProcessor.js";import{SizedPixelFormat as h,TextureSamplingMode as g,PixelType as w,TextureWrapMode as x}from"../../../../webgl/enums.js";import{Texture as T}from"../../../../webgl/Texture.js";import{TextureDescriptor as b}from"../../../../webgl/TextureDescriptor.js";const v=new Map;function A(r,e){const o=new b;return o.width=r,o.height=e,o.internalFormat=h.RGBA32F,o.samplingMode=g.NEAREST,o.dataType=w.FLOAT,o.isImmutable=!0,o.wrapMode=x.CLAMP_TO_EDGE,o}function F(r,e,o,t){const{context:s,requestRender:c,allowDelayedRender:n}=r,i=t.createProgram(r,o);return n&&null!=c&&!i.compiled?(c(),null):(s.bindFramebuffer(e),s.setViewport(0,0,e.width,e.height),s.useProgram(i),i)}function y(r){return v.get(r.toLowerCase())}function R(r,e,o,t){const s=r.rasterFunction.name.toLowerCase(),c="reproject"===s?j:y(s);if(null==c)return;const n=F(r,o,t,c);if(!n)return;c.bindTextureAndUniforms(r,n,t);const{interpolation:i}=t;"reproject"===s&&(t.interpolation="nearest"),e.draw();const[m,a]=t.getRasterTextureSize("reproject"===s),p=A(m,a),u=new T(r.context,p);if(o.copyToTexture(0,0,m,a,0,0,u),"reproject"===s)t.rasterTexture=u,t.projected=!0,t.interpolation=i;else{const e=r.hasBranches?r.rasterFunction.id:0;t.functionTextures[e]=u}}v.set("arithmetic",p),v.set("aspect",r),v.set("bandarithmetic",e),v.set("computechange",t),v.set("compositeband",o),v.set("convolution",c),v.set("contrastbrightness",s),v.set("curvature",n),v.set("extractband",i),v.set("statistics",m),v.set("grayscale",a),v.set("local",p),v.set("mask",u),v.set("ndvi",f),v.set("remap",l),v.set("slope",d),v.set("stretch",P);export{A as createTextureDescriptor,R as process};
