/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{WGLDrawPhase as e,FeatureSymbologyDrawOrder as s}from"../../../enums.js";import{FeatureTechnique as t}from"../FeatureTechnique.js";import{getSelectionDefines as a,getFeaturePipelineState as i,resolveDynamicUniforms as r,getFeatureUniforms as o,isHittest as n}from"../featureTechniqueUtils.js";import{TechniqueType as u}from"../TechniqueType.js";import{TextShader as m}from"../text/TextShader.js";class p extends t{constructor(){super(...arguments),this.type=u.Label,this.shaders={geometry:new m},this.drawPhase=e.LABEL|e.LABEL_ALPHA|e.HITTEST,this.symbologyPlane=s.TEXT}render(e,s){const{context:t,painter:u}=e,m=a(e),p={...i(e)},d=s.instance.getInput(),h={shader:this.shaders.geometry,uniforms:{...r(e,s.target,d.uniforms),...o(e,s.target),mosaicInfo:u.textureManager.getMosaicInfo(t,s.textureKey)},defines:{...m,isHaloPass:!1,isBackgroundPass:!0,isLabel:!0},optionalAttributes:d.optionalAttributes,useComputeBuffer:n(e)};u.setShader(h),u.setPipelineState(p),u.submitDraw(e,s),u.setShader({...h,defines:{...m,isHaloPass:!0,isBackgroundPass:!1,isLabel:!0}}),u.setPipelineState(p),u.submitDraw(e,s),u.setShader({...h,defines:{...m,isHaloPass:!1,isBackgroundPass:!1,isLabel:!0}}),u.setPipelineState(p),u.submitDraw(e,s)}}export{p as LabelTechnique};
