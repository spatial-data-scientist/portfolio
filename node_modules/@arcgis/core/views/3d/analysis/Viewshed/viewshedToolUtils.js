/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{rad2deg as t}from"../../../../core/mathUtils.js";import{len as r,set as e}from"../../../../core/libs/gl-matrix-2/math/vec2.js";import{create as o}from"../../../../core/libs/gl-matrix-2/factories/vec2f64.js";import{b as i,c as n,n as s,z as a,m as c}from"../../../../chunks/vec32.js";import{create as m}from"../../../../core/libs/gl-matrix-2/factories/vec3f64.js";import{distance as f}from"../../../../geometry/geometryEngine.js";import{sv3d as l}from"../../../../geometry/support/vectorStacks.js";import{calculateTranslateRotateFromBases as p,calculateInputRotationTransform as g}from"../../interactive/manipulatorUtils.js";import{screenToRenderPlane as u}from"../../interactive/editingTools/dragEventPipeline3D.js";function b({tiltedUpVector:t,rightVector:r,observerRenderSpace:e},o){const i=p(t,r,e,o);return i[12]=0,i[13]=0,i[14]=0,i}function v(t,r,{origin:o,basis1:i,basis2:n}){const m=s(l.get(),i),f=s(l.get(),n),p=a(l.get(),r,o);return e(t,c(p,m),c(p,f))}function j(e,o){const i=v(h,e,o),[n,s]=i;let a=Math.acos(n/r(i));return s<0&&(a=2*Math.PI-a),t(a)}function d(r,e,o){const s=m(),a=i(m(),o.basis1,o.basis2);return r.next(u(e,o.plane)).next((r=>{"start"===r.action&&n(s,r.renderStart);const e=t(g(s,r.renderEnd,o.origin,a));return{...r,deltaAngle:e}}))}function x(t,r){if(null==t)return 0;const{observer:e,target:o}=t,i=r.camera.position,n=f(i,e)>f(i,o)?e:o;return r.pixelSizeAt(n)}const h=o();export{j as angleFromPointAndCircle,x as computeOffsetScale,b as getViewshedRotationMatrix,d as screenToCircleAngle};
