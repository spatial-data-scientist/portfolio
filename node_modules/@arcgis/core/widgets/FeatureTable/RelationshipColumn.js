/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{_ as t}from"../../chunks/tslib.es6.js";import{property as e}from"../../core/accessorSupport/decorators/property.js";import"../../core/has.js";import"../../core/Logger.js";import"../../core/RandomLCG.js";import{subclass as o}from"../../core/accessorSupport/decorators/subclass.js";import{substitute as i}from"../../intl/substitute.js";import r from"./Grid/Column.js";import{isIFeatureTableSupportedLayerWithRelationships as s}from"./support/tableUtils.js";const l={showRecordsButton:"esri-column__show-related-records-button"};let n=class extends r{constructor(t){super(t),this.flexGrow=1,this.icon="link",this.layer=null,this.relatedLayer=null,this.relationshipId=null,this.renderFunction=({root:t,rowData:e})=>{if(!e)return;const o=e.item,{layer:r,relatedLayer:n}=this;if(!o?.feature||!s(r)||!s(n))return;const{messages:a}=this,{index:p}=e,{feature:c}=o,{collapsed:d,showRelatedTableCallback:h,relationshipId:u}=this,y=o.relatedRecords,b=y?.find((t=>t.relationshipId===u))?.count??0,f=!d&&h&&a?.recordsCount?i(a.recordsCount,{count:b}):`${b}`,m=t=>{t.preventDefault(),d||this.showRelatedTableCallback?.({feature:c,index:p,layer:r,relatedLayer:n,relationshipId:u})},C=d?"":"chevron-right";if(t.firstChild){const e=t.firstChild;return e.textContent=f,e.onclick=m,void(e.iconEnd=C)}const g=this.createCalciteButton({className:l.showRecordsButton,iconEnd:C,iconFlipRtl:"both",scale:"m",textContent:f,onclick:m});this.removeCellContent(t),t.appendChild(g)},this.resizable=!0,this.showRelatedTableCallback=null,this.textAlign="center",this.width="200px"}get _relationshipLabel(){return this.label||this.originRelationship?.name||this.layer.title||""}get collapsed(){return this._get("collapsed")||!1}set collapsed(t){t?this.set({flexGrow:0,resizable:!1,width:"80px"}):this.set({flexGrow:1,resizable:!0,width:"200px"}),this._set("collapsed",t)}get effectiveLabel(){return this.collapsed?"":this._relationshipLabel}get iconNode(){const{icon:t}=this;return t?this.createCalciteIcon({icon:t,textLabel:this._relationshipLabel}):null}get originRelationship(){const t=this.relationshipId;return this.relatedLayer.relationships?.find((({id:e})=>e===t))}get relationship(){const t=this.relationshipId;return this.layer.relationships?.find((({id:e})=>e===t))}};t([e()],n.prototype,"_relationshipLabel",null),t([e()],n.prototype,"collapsed",null),t([e()],n.prototype,"effectiveLabel",null),t([e()],n.prototype,"flexGrow",void 0),t([e()],n.prototype,"icon",void 0),t([e()],n.prototype,"iconNode",null),t([e()],n.prototype,"layer",void 0),t([e()],n.prototype,"originRelationship",null),t([e()],n.prototype,"relatedLayer",void 0),t([e()],n.prototype,"relationship",null),t([e()],n.prototype,"relationshipId",void 0),t([e()],n.prototype,"renderFunction",void 0),t([e()],n.prototype,"resizable",void 0),t([e()],n.prototype,"showRelatedTableCallback",void 0),t([e()],n.prototype,"textAlign",void 0),t([e()],n.prototype,"width",void 0),n=t([o("esri.widgets.FeatureTable.RelationshipColumn")],n);const a=n;export{a as default};
