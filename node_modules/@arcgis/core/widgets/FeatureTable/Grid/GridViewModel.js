/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{_ as t}from"../../../chunks/tslib.es6.js";import e from"../../../core/Collection.js";import{referenceSetter as o}from"../../../core/collectionUtils.js";import i from"../../../core/Evented.js";import{property as n}from"../../../core/accessorSupport/decorators/property.js";import"../../../core/has.js";import"../../../core/Logger.js";import"../../../core/RandomLCG.js";import{subclass as r}from"../../../core/accessorSupport/decorators/subclass.js";import{uniqueColumnNames as s}from"../support/tableUtils.js";let l=class extends i.EventedAccessor{constructor(t){super(t),this.cellPartNameGenerator=(t,e)=>{let o="";e?.item&&this.rowHighlightIds.includes(e.item.objectId)&&(o+=" highlight");const i=this.findColumn(t?.path);return i?(i.invalid&&(o+=" invalid"),i.textWrap&&(o+=" text-wrap"),"editInfo"in i&&i.editInfo&&i.editInfo.rowData?.index===e.index&&(o+=" editing"),o):o},this.columnPerformanceModeEnabled=!0,this.columnReorderingEnabled=!0,this.columns=new e,this.dataProvider=async(t,e)=>{const{store:o}=this;if(!e)return;if(!o)return void(e&&e([]));e(await o.fetchItems(t))},this.multipleSelectionEnabled=!0,this.multiSortEnabled=!1,this.pageSize=50,this.rowDetailsRenderer=null,this.store=null}get actionColumn(){return this.columns.find((t=>t.fieldName===s.action))}get attachmentsColumn(){return this.columns.find((t=>t.fieldName===s.attachments))}get columnMenuIsOpen(){return this.columns.some((t=>t.menuIsOpen))}get editing(){return this.editorColumns.some((t=>t.editInfo))}get editorColumns(){return this.columns.toArray().filter((t=>"editable"in t))}get fieldColumns(){return this.columns.toArray().filter((t=>"field"in t))}get filterBySelectionEnabled(){return!!this._get("filterBySelectionEnabled")}set filterBySelectionEnabled(t){this._set("filterBySelectionEnabled",t)}get highlightIds(){return this._get("highlightIds")||new e}set highlightIds(t){const i=Array.isArray(t)?new e(t):t;this.multipleSelectionEnabled||i.splice(1,i.length-1),this._set("highlightIds",o(i,this._get("highlightIds"),e))}get relationshipColumns(){return this.columns.toArray().filter((t=>"relationshipId"in t))}get rowHighlightIds(){return this._get("rowHighlightIds")||new e}set rowHighlightIds(t){this._set("rowHighlightIds",o(t,this._get("rowHighlightIds"),e))}get size(){return this.filterBySelectionEnabled&&!this.highlightIds.length?0:this.store?.count||0}get state(){return this.store?.state??"disabled"}closeColumnMenus(){this.columns.forEach((t=>t.closeMenu()))}sortColumn(t,e){if(!t)return;const o=this.findColumn(t);o&&(o.direction=e)}hideColumn(t){const e=this.findColumn(t);!1===e?.hidden&&(e.hidden=!0)}showColumn(t){const e=this.findColumn(t);e?.hidden&&(e.hidden=!1)}showAllColumns(){this.columns.forEach((t=>{t.hidden&&(t.hidden=!1)}))}findColumn(t){const e=[];return this.columns.forEach((t=>{e.push(t),"columns"in t&&t.columns?.forEach((t=>e.push(t)))})),e.find((e=>e.fieldName===t))}getRowItemAt(t){return this.store?.getLocalItemAt(t)}refresh(){this.store&&(this.store.reset(),this.store.load())}toggleColumnVisibility(t){const e=this.findColumn(t);e&&(e.hidden=!e.hidden)}};t([n()],l.prototype,"actionColumn",null),t([n()],l.prototype,"attachmentsColumn",null),t([n()],l.prototype,"cellPartNameGenerator",void 0),t([n()],l.prototype,"columnMenuIsOpen",null),t([n()],l.prototype,"columnPerformanceModeEnabled",void 0),t([n()],l.prototype,"columnReorderingEnabled",void 0),t([n()],l.prototype,"columns",void 0),t([n()],l.prototype,"dataProvider",void 0),t([n()],l.prototype,"editing",null),t([n()],l.prototype,"editorColumns",null),t([n()],l.prototype,"fieldColumns",null),t([n()],l.prototype,"filterBySelectionEnabled",null),t([n()],l.prototype,"highlightIds",null),t([n()],l.prototype,"multipleSelectionEnabled",void 0),t([n()],l.prototype,"multiSortEnabled",void 0),t([n()],l.prototype,"pageSize",void 0),t([n()],l.prototype,"relationshipColumns",null),t([n()],l.prototype,"rowHighlightIds",null),t([n()],l.prototype,"rowDetailsRenderer",void 0),t([n({readOnly:!0})],l.prototype,"size",null),t([n()],l.prototype,"store",void 0),t([n({readOnly:!0})],l.prototype,"state",null),l=t([r("esri.widgets.FeatureTable.Grid.GridViewModel")],l);const d=l;export{d as default};
